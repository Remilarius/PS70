<!DOCTYPE html>
<html lang="en-US">
  <head>
  

  

  <title>
    
    Week 9: WiFi and Bluetooth (IoT) | Joy Lin
  </title>

  <meta name="title" content="Week 9: WiFi and Bluetooth (IoT) | Joy Lin">

  <meta charset="utf-8">
  
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer-when-downgrade">
  <base href="https://remilarius.github.io/PS70/">

  <meta name="description" content="osprey-delight example site">

  <meta name="author" content="kdevo">

  

  <meta property="og:title" content="Week 9: WiFi and Bluetooth (IoT) | Joy Lin">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://remilarius.github.io/PS70/">

  <meta property="og:image" content="https://remilarius.github.io/PS70//images/osprey-delight.png">

  <meta property="og:description" content="osprey-delight example site">

  <link rel="icon" type="image/png" href="anchoricon.png">

  <meta name="theme-color" content="#0097a7">

  <link rel="canonical" href="https://remilarius.github.io/PS70/blog/week-9/">
  
  

  <link rel="stylesheet" href="https://remilarius.github.io/PS70/style.8bf9e65afd7249b538482c017b52bc4aab6c35fb771c80a22694935428991e48.css" type="text/css">

  <script type="application/ld+json">
  {"@context":"http://www.schema.org","@type":"Person","@id":"https://remilarius.github.io/PS70/","name":"kdevo","url":"https://remilarius.github.io/PS70/","description":"osprey-delight example site","sameAs":["","https://github.com/Remilarius","","",""]}
  </script>

  <style>.lazyload{opacity:.0001;}.logo .lazyload{min-width:10em;}</style>
    <script src="https://remilarius.github.io/PS70/js/vendor/lazysizes.min.js" async></script>
</head>

  <body>
    



<nav class="row middle-xs center-xs">
  <div class="col-xs-6 col-sm-1 logo">
    <a href="/PS70/#"><img data-src="anchoricon.png" class="lazyload" lazyload="on" alt="Joy Lin"></a>
  </div>
    
      <div class="col-xs-3 col-sm-2 nav-item">
        <h3><a href="/PS70/#about">About</a></h3>
      </div>
    
      <div class="col-xs-3 col-sm-2 nav-item">
        <h3><a href="/PS70/#work">Work</a></h3>
      </div>
    
      <div class="col-xs-3 col-sm-2 nav-item">
        <h3><a href="/PS70/#blog">Blog</a></h3>
      </div>
    
      <div class="col-xs-3 col-sm-2 nav-item">
        <h3><a href="/PS70/#contact">Contact</a></h3>
      </div>
    
  <div class="col-xs-6 col-sm-1 nav-toggle">
      <a href="" class="nav-icon" onclick="return false">
        <i id="open" class="icon icon-2x icon-menu"></i>
      </a>
  </div>
</nav>

<section class="nav-full row middle-xs center-xs">
  <div class="col-xs-12">
    <div class="row middle-xs center-xs">
      
        <div class="col-xs-12"><h1><a href="/PS70/#about">About</a></h1></div>
      
        <div class="col-xs-12"><h1><a href="/PS70/#work">Work</a></h1></div>
      
        <div class="col-xs-12"><h1><a href="/PS70/#blog">Blog</a></h1></div>
      
        <div class="col-xs-12"><h1><a href="/PS70/#contact">Contact</a></h1></div>
      
    </div>
  </div>
</section>

    <main>

      <section class="container">
        <section class="content">
          <h1> Week 9: WiFi and Bluetooth (IoT) </h1>

            <div class="sub-header">
              March 30, 2021 Â· 2 minutes read
            </div>

          <article class="entry-content">
            <h3 id="ble">BLE</h3>
<p>I thought I&rsquo;d try the BLE subset of the assignment since my team had been thinking about ways to control a drone and BLE was one of the options we were considering.</p>
<p>I followed the instructions on the class website and uploaded the BLE_write program from examples</p>
<p>For the LED specifically, there was this code also on the class website.
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html">/*
    Based on Neil Kolban example for IDF: https://github.com/nkolban/esp32-snippets/blob/master/cpp_utils/tests/BLE%20Tests/SampleWrite.cpp
    Ported to Arduino ESP32 by Evandro Copercini
*/
#include <span class="p">&lt;</span><span class="nt">BLEDevice.h</span><span class="p">&gt;</span>
#include <span class="p">&lt;</span><span class="nt">BLEUtils.h</span><span class="p">&gt;</span>
#include <span class="p">&lt;</span><span class="nt">BLEServer.h</span><span class="p">&gt;</span>
// See the following for generating UUIDs:
// https://www.uuidgenerator.net/
#define SERVICE_UUID        &#34;4fafc201-1fb5-459e-8fcc-c5c9c331914b&#34;
#define CHARACTERISTIC_UUID &#34;beb5483e-36e1-4688-b7f5-ea07361b26a8&#34;
int LED_PIN = 5;
char LED_STATUS;
class MyCallbacks: public BLECharacteristicCallbacks {
    void onWrite(BLECharacteristic *pCharacteristic) {
      std::string value = pCharacteristic-&gt;getValue();
      if (value.length() &gt; 0) { 
        for (int i = 0; i <span class="p">&lt;</span> <span class="nt">value.length</span><span class="err">();</span> <span class="na">i</span><span class="err">++){</span>
          <span class="na">LED_STATUS </span><span class="o">=</span> <span class="s">value[i];</span>
        <span class="err">}</span>
      <span class="err">}</span>
    <span class="err">}</span>
<span class="err">};</span>
<span class="na">void</span> <span class="na">setup</span><span class="err">()</span> <span class="err">{</span>
  <span class="na">Serial</span><span class="err">.</span><span class="na">begin</span><span class="err">(</span><span class="na">115200</span><span class="err">);</span>
  <span class="na">BLEDevice::init</span><span class="err">(&#34;</span><span class="na">MyESP32</span><span class="err">&#34;);</span>
  <span class="na">BLEServer</span> <span class="err">*</span><span class="na">pServer </span><span class="o">=</span> <span class="s">BLEDevice::createServer();</span>
  <span class="na">BLEService</span> <span class="err">*</span><span class="na">pService </span><span class="o">=</span> <span class="s">pServer-</span><span class="p">&gt;</span>createService(SERVICE_UUID);
  BLECharacteristic *pCharacteristic = pService-&gt;createCharacteristic(
                                         CHARACTERISTIC_UUID,
                                         BLECharacteristic::PROPERTY_READ |
                                         BLECharacteristic::PROPERTY_WRITE
                                       );
  pCharacteristic-&gt;setCallbacks(new MyCallbacks());
  pCharacteristic-&gt;setValue(&#34;Hello World&#34;);
  pService-&gt;start();
  BLEAdvertising *pAdvertising = pServer-&gt;getAdvertising();
  pAdvertising-&gt;start();
  pinMode(LED_PIN, OUTPUT);
  digitalWrite(LED_PIN, LOW);
}
void loop() {
  int val = (int)LED_STATUS;  // cast the char* as an int 
  if (val == 49)              // ASCII code for the number 1
    digitalWrite(LED_PIN, HIGH);
  else 
    digitalWrite(LED_PIN, LOW);

  delay(2000);
}</code></pre></div></p>
<h3 id="ble-scanner-app">BLE Scanner App</h3>
<p>I downloaded the basic BLE scanner from the app store and found my device on the scanner (there were a lot of devices that showed on the device surprisingly).</p>
<p><img src="Week9/devicepage.PNG" alt="Devicepage">
<img src="Week9/write.jpg" alt="write">
<img src="Week9/write1.jpg" alt="Write 1">
<img src="Week9/LEDON.jpg" alt="LEDon"></p>
<p>I notice a 1-2 second lag between writing 1 or 0 in the app and the LED turning on and off. After getting rid of the delay, the response was almost instantaneous.</p>
<p>I was originally concerned about the lag in piloting something like a drone, but now that I know it&rsquo;s possible for the board to be pretty responsive, the problem is getting a better UI than having to write in numbers or HEX.</p>
<p>One solution to being limited by having to write text or HEX is to build command packets but I don&rsquo;t exactly know to what to map over as of yet.</p>

          </article>

          <div class="pagination">
            
              <a href="https://remilarius.github.io/PS70/blog/week-8/">&laquo; Week 8: Radio Communication</a>
            
            
              <a href="https://remilarius.github.io/PS70/blog/week10/">Week 10: Machine Building and End Effectors &raquo;</a>
            
          </div>
        </section>
        <br>
        <section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;
      var disqus_shortname = '';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view comments powered by <a href="http://disqus.com/?ref_noscript">Disqus</a>.</noscript>
</section>

      </section>

    </main>
    <footer class="row middle-xs center-xs">
  <div class="col-xs-2">
      <a target="_blank" rel="noopener" href=""><i class="icon icon-facebook"></i></a>
    </div><div class="col-xs-2">
      <a target="_blank" rel="noopener" href="https://github.com/Remilarius"><i class="icon icon-github"></i></a>
    </div><div class="col-xs-2">
      <a target="_blank" rel="noopener" href=""><i class="icon icon-linkedin"></i></a>
    </div><div class="col-xs-2">
      <a target="_blank" rel="noopener" href=""><i class="icon icon-stackoverflow"></i></a>
    </div><div class="col-xs-2">
      <a target="_blank" rel="noopener" href=""><i class="icon icon-twitter"></i></a>
    </div>
  <div class="col-xs-12">
      <small>
      
      Copyright &copy; 2021 Joy Lin
      
      <div class="col-xs-12">
          <small>Theme: <a href="https://github.com/kdevo/osprey-delight" target="_blank">osprey-delight</a> (fork of <a href="https://github.com/tomanistor/osprey" target="_blank">osprey</a>).</small>
      </div>
      </small>
    </div>
</footer>

    






  <script src="https://remilarius.github.io/PS70/js/bundle.min.39ae3d25b4813183a9708ec4e3146f9eda83dcd89f1f2e0258bc4302e806df7d.js" type="text/javascript"></script>
  <script>handleNavBar( false )</script>

  </body>
</html>